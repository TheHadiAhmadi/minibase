import{S as U,i as G,s as K,a1 as Q,e as A,v as g,c as O,a as V,w as h,d as _,f as T,x as b,p as m,n as p,A as v,u as W,a2 as P,j as S,l as C,_ as X,t as B,g as N,b as E,F as I,m as F,o as H,h as Y,a3 as Z,a4 as x,a5 as y,a6 as q,a7 as ee,$ as te,a0 as ae,L as J,H as ne}from"../../chunks/vendor-ec71dcdf.js";import{p as se,i as re}from"../../chunks/navigation-f051a548.js";import"../../chunks/singletons-12a22614.js";function L(o,e,a){const t=o.slice();return t[5]=e[a],t}function M(o){let e,a;return e=new J({props:{name:"fas-check"}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,r){b(e,t,r),a=!0},i(t){a||(m(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){v(e,t)}}}function le(o){let e;return{c(){e=B("Open")},l(a){e=N(a,"Open")},m(a,t){T(a,e,t)},d(a){a&&_(e)}}}function oe(o){let e,a;return e=new J({props:{name:"fas-trash-alt"}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,r){b(e,t,r),a=!0},p:ne,i(t){a||(m(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){v(e,t)}}}function R(o){let e,a,t,r=o[5].name+"",s,u,d,c,f,D,w,k,n=o[5].schema&&M();return f=new q({props:{size:"sm",$$slots:{default:[le]},$$scope:{ctx:o}}}),w=new q({props:{size:"sm",compact:!0,variant:"error",$$slots:{default:[oe]},$$scope:{ctx:o}}}),{c(){e=A("div"),n&&n.c(),a=S(),t=A("a"),s=B(r),d=S(),c=A("div"),g(f.$$.fragment),D=S(),g(w.$$.fragment),this.h()},l(l){e=O(l,"DIV",{class:!0});var i=V(e);n&&n.l(i),a=C(i),t=O(i,"A",{"sveltekit:prefetch":!0,href:!0});var j=V(t);s=N(j,r),j.forEach(_),d=C(i),c=O(i,"DIV",{class:!0});var $=V(c);h(f.$$.fragment,$),D=C($),h(w.$$.fragment,$),$.forEach(_),i.forEach(_),this.h()},h(){E(t,"sveltekit:prefetch",""),E(t,"href",u="./"+o[1]+"/"+o[5].name),E(c,"class","flex space-x-1"),E(e,"class","p-4 mt-2 shadow-lg flex items-center justify-between rounded-lg bg-blue-100 border border-blue-400")},m(l,i){T(l,e,i),n&&n.m(e,null),I(e,a),I(e,t),I(t,s),I(e,d),I(e,c),b(f,c,null),I(c,D),b(w,c,null),k=!0},p(l,i){l[5].schema?n?i&1&&m(n,1):(n=M(),n.c(),m(n,1),n.m(e,a)):n&&(F(),p(n,1,1,()=>{n=null}),H()),(!k||i&1)&&r!==(r=l[5].name+"")&&Y(s,r),(!k||i&3&&u!==(u="./"+l[1]+"/"+l[5].name))&&E(t,"href",u);const j={};i&256&&(j.$$scope={dirty:i,ctx:l}),f.$set(j);const $={};i&256&&($.$$scope={dirty:i,ctx:l}),w.$set($)},i(l){k||(m(n),m(f.$$.fragment,l),m(w.$$.fragment,l),k=!0)},o(l){p(n),p(f.$$.fragment,l),p(w.$$.fragment,l),k=!1},d(l){l&&_(e),n&&n.d(),v(f),v(w)}}}function fe(o){let e;return{c(){e=B("Add")},l(a){e=N(a,"Add")},m(a,t){T(a,e,t)},d(a){a&&_(e)}}}function ce(o){let e,a,t,r,s,u,d,c=o[0],f=[];for(let n=0;n<c.length;n+=1)f[n]=R(L(o,c,n));const D=n=>p(f[n],1,1,()=>{f[n]=null});function w(n){o[4](n)}let k={bordered:!0,placeholder:"New Table",shadow:!0};return o[2].name!==void 0&&(k.value=o[2].name),t=new Z({props:k}),x.push(()=>y(t,"value",w)),u=new q({props:{shadow:!0,$$slots:{default:[fe]},$$scope:{ctx:o}}}),u.$on("click",o[3]),{c(){for(let n=0;n<f.length;n+=1)f[n].c();e=S(),a=A("div"),g(t.$$.fragment),s=S(),g(u.$$.fragment),this.h()},l(n){for(let i=0;i<f.length;i+=1)f[i].l(n);e=C(n),a=O(n,"DIV",{class:!0});var l=V(a);h(t.$$.fragment,l),s=C(l),h(u.$$.fragment,l),l.forEach(_),this.h()},h(){E(a,"class","flex mt-4 pt-4 border-t border-dashed border-gray-200 space-x-2")},m(n,l){for(let i=0;i<f.length;i+=1)f[i].m(n,l);T(n,e,l),T(n,a,l),b(t,a,null),I(a,s),b(u,a,null),d=!0},p(n,l){if(l&3){c=n[0];let $;for($=0;$<c.length;$+=1){const z=L(n,c,$);f[$]?(f[$].p(z,l),m(f[$],1)):(f[$]=R(z),f[$].c(),m(f[$],1),f[$].m(e.parentNode,e))}for(F(),$=c.length;$<f.length;$+=1)D($);H()}const i={};!r&&l&4&&(r=!0,i.value=n[2].name,ee(()=>r=!1)),t.$set(i);const j={};l&256&&(j.$$scope={dirty:l,ctx:n}),u.$set(j)},i(n){if(!d){for(let l=0;l<c.length;l+=1)m(f[l]);m(t.$$.fragment,n),m(u.$$.fragment,n),d=!0}},o(n){f=f.filter(Boolean);for(let l=0;l<f.length;l+=1)p(f[l]);p(t.$$.fragment,n),p(u.$$.fragment,n),d=!1},d(n){te(f,n),n&&_(e),n&&_(a),v(t),v(u)}}}function ue(o){let e;return{c(){e=B("Tables")},l(a){e=N(a,"Tables")},m(a,t){T(a,e,t)},d(a){a&&_(e)}}}function ie(o){let e,a;return e=new ae({props:{slot:"title",$$slots:{default:[ue]},$$scope:{ctx:o}}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,r){b(e,t,r),a=!0},p(t,r){const s={};r&256&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){a||(m(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){v(e,t)}}}function $e(o){let e,a;return e=new X({props:{compact:!0,$$slots:{title:[ie],default:[ce]},$$scope:{ctx:o}}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,r){b(e,t,r),a=!0},p(t,r){const s={};r&263&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){a||(m(e.$$.fragment,t),a=!0)},o(t){p(e.$$.fragment,t),a=!1},d(t){v(e,t)}}}function me(o){let e;return{c(){e=B("Settings")},l(a){e=N(a,"Settings")},m(a,t){T(a,e,t)},d(a){a&&_(e)}}}function pe(o){let e,a,t,r;return e=new P({props:{name:"Data",$$slots:{default:[$e]},$$scope:{ctx:o}}}),t=new P({props:{name:"settings",$$slots:{default:[me]},$$scope:{ctx:o}}}),{c(){g(e.$$.fragment),a=S(),g(t.$$.fragment)},l(s){h(e.$$.fragment,s),a=C(s),h(t.$$.fragment,s)},m(s,u){b(e,s,u),T(s,a,u),b(t,s,u),r=!0},p(s,u){const d={};u&263&&(d.$$scope={dirty:u,ctx:s}),e.$set(d);const c={};u&256&&(c.$$scope={dirty:u,ctx:s}),t.$set(c)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){p(e.$$.fragment,s),p(t.$$.fragment,s),r=!1},d(s){v(e,s),s&&_(a),v(t,s)}}}function _e(o){let e,a,t;return a=new Q({props:{lifted:!0,$$slots:{default:[pe]},$$scope:{ctx:o}}}),{c(){e=A("div"),g(a.$$.fragment)},l(r){e=O(r,"DIV",{});var s=V(e);h(a.$$.fragment,s),s.forEach(_)},m(r,s){T(r,e,s),b(a,e,null),t=!0},p(r,[s]){const u={};s&263&&(u.$$scope={dirty:s,ctx:r}),a.$set(u)},i(r){t||(m(a.$$.fragment,r),t=!0)},o(r){p(a.$$.fragment,r),t=!1},d(r){r&&_(e),v(a)}}}async function ve({page:o,fetch:e}){return{props:{tables:await e(`/api/${o.params.app}`).then(a=>a.json()),app_name:o.params.app}}}function de(o,e,a){let{tables:t}=e,{app_name:r}=e,s={};W(async()=>{const c=await se();console.log("prefetch",c)});async function u(){var f;const c=await fetch(`/api/${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s.name,shcema:(f=s.schema)!=null?f:{}})}).then(D=>D.json());console.log("add Table: ",c),c.acknowledged&&(await re(`/api/${s}`),a(2,s.name="",s),a(2,s.schema={},s))}function d(c){o.$$.not_equal(s.name,c)&&(s.name=c,a(2,s))}return o.$$set=c=>{"tables"in c&&a(0,t=c.tables),"app_name"in c&&a(1,r=c.app_name)},[t,r,s,u,d]}class we extends U{constructor(e){super();G(this,e,de,_e,K,{tables:0,app_name:1})}}export{we as default,ve as load};
